commonfields:
  id: OneTrust
  version: -1
vcShouldKeepItemLegacyProdMachine: false
name: OneTrust
display: OneTrust
category: Utilities
image: data:image/png;base64,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
description: "We are building a DEV OneTrust integration. \nCurrently in POC fase"
detaileddescription: |-
  ### Community Contributed Integration
   #### Integration Author: Cortex XSOAR
   No support or maintenance is provided by the author. Customers are encouraged to engage with the user community for questions and guidance at the [Cortex XSOAR Live Discussions](https://live.paloaltonetworks.com/t5/cortex-xsoar-discussions/bd-p/Cortex_XSOAR_Discussions).
  ***
  ## Hello World
  - This section explains how to configure the instance of HelloWorld in Cortex XSOAR.
  - You can use the following API Key: `43ea9b2d-4998-43a6-ae91-aba62a26868c`

  ---
  [View Integration Documentation](https://xsoar.pan.dev/docs/reference/integrations/hello-world)
configuration:
- display: Server URL OneTrust
  name: url
  defaultvalue: https://www.uat-de.onetrust.com
  type: 0
  required: true
- display: Fetch incidents
  name: isFetch
  type: 8
  required: false
- display: Incident type
  name: incidentType
  type: 13
  required: false
- display: Maximum number of incidents per fetch
  name: max_fetch
  defaultvalue: "20"
  type: 0
  required: false
- display: First fetch time
  name: first_fetch
  defaultvalue: 3 days
  type: 0
  required: false
- display: Trust any certificate (not secure)
  name: insecure
  type: 8
  required: false
- display: Use system proxy settings
  name: proxy
  type: 8
  required: false
- display: Incidents Fetch Interval
  name: incidentFetchInterval
  defaultvalue: "1"
  type: 19
  required: false
- display: OAuth2.0 Token
  name: OAuthToken
  type: 4
  required: true
script:
  script: |
    register_module_line('HelloWorld', 'start', __line__())
    ### pack version: 1.2.19
    """HelloWorld Integration for Cortex XSOAR (aka Demisto)

    This integration is a good example on you can build a Cortex XSOAR Integration
    using Python 3. Please follow the documentation links below and make sure that
    your integration follows the Code Conventions and passes the Linting phase.

    Developer Documentation: https://xsoar.pan.dev/docs/welcome
    Code Conventions: https://xsoar.pan.dev/docs/integrations/code-conventions
    Linting: https://xsoar.pan.dev/docs/integrations/linting

    When building a Cortex XSOAR integration that is reusable, a lot of effort
    must be placed in the design. We recommend to fill a Design Document template,
    that allows you to capture Use Cases, Requirements and Inputs/Outputs.

    Example Design document for the this Integration (HelloWorld):
    https://docs.google.com/document/d/1wETtBEKg37PHNU8tYeB56M1LE314ux086z3HFeF_cX0
    #working with

    HelloWorld API
    --------------
    datetime.
    The HelloWorld API is a simple API that shows a realistic use case for an XSOAR
    integration. It's actually a real API that is available to the following URL:
    https://soar.mastersofhack.com - if you need an API Key to test it out please
    reach out to your Cortex XSOAR contacts.

    This API has a few basic functions:
    - Alerts: the endpoint returns mocked alerts and allows you to search based on
    a number of parameters, such as state (ACTIVE or CLOSED), type, timestamp. It
    can also return a single alert by ID. This is used to create new Incidents in
    XSOAR by using the ``fetch-incidents`` command, which is by default invoked
    every minute.
    There is also an endpoint that allows to retrieve additional details about a
    specific alert by ID, and one to change the alert status to "CLOSED" once
    it has been resolved.

    - Reputation (ip and domain): these endpoints return, for an IP and
    domain respectively, a WHOIS lookup of the entity as well as a reputation score
    (from 0 to 100) that is used to determine whether the entity is malicious. This
    endpoint is called by XSOAR reputation commands ``ip`` and ``domain`` that
    are run automatically every time an indicator is extracted in XSOAR. As a best
    practice of design, it is important to map and document the mapping between
    a score in the original API format (0 to 100 in this case) to a score in XSOAR
    format (0 to 3). This score is called ``DBotScore``, and is returned in the
    context to allow automated handling of indicators based on their reputation.
    More information: https://xsoar.pan.dev/docs/integrations/dbot


    - Scan: to demonstrate how to run commands that are not returning instant data,
    the API provides a scan endpoint that simulates scanning a host and generating
    a report after the scan is completed. The API has endpoints to start a scan,
    which returns a job ID, poll for the scan status and, if the scan is completed,
    retrieved the job results.
    This function is used in conjunction of the HelloWorld Scan playbook that uses
    the GenericPolling mechanism to implement the job polling loop. The results
    can be returned in JSON or attachment file format.
    Info on GenericPolling: https://xsoar.pan.dev/docs/playbooks/generic-polling

    Please check the HelloWorld Design Document referenced above for details about
    the raw API responsens as well as the design details for this integration.

    This integration also has a ``say-hello`` command for backward compatibility,
    that doesn't connect to an API and just returns a ``Hello {name}`` string,
    where name is the input value provided.


    Integration File Structure
    --------------------------

    An integration usually consists of the following parts:
    - Imports
    - Constants
    - Client Class
    - Helper Functions
    - Command Functions
    - Main Function
    - Entry Point


    Imports
    -------

    Here you can import Python module you need for your integration. If you need
    a module that is not part of the default XSOAR Docker images, you can add
    a custom one. More details: https://xsoar.pan.dev/docs/integrations/docker

    There are also internal imports that are used by XSOAR:
    - demistomock (imported as demisto): allows your code to work offline for
    testing. The actual ``demisto`` module is provided at runtime when the
    code runs in XSOAR.
    - CommonServerPython.py: contains a set of helper functions, base classes
    and other useful components that will make your integration code easier
    to maintain.
    - CommonServerUserPython.py: includes a set of user defined commands that
    are specific to an XSOAR installation. Do not use it for integrations that
    are meant to be shared externally.

    These imports are automatically loaded at runtime within the XSOAR script
    runner, so you shouldn't modify them

    Constants
    ---------

    Usually some constants that do not require user parameters or inputs, such
    as the default API entry point for your service, or the maximum numbers of
    incidents to fetch every time.


    Client Class
    ------------

    We recommend to use a Client class to wrap all the code that needs to interact
    with your API. Moreover, we recommend, when possible, to inherit from the
    BaseClient class, defined in CommonServerPython.py. This class already handles
    a lot of the work, such as system proxy settings, SSL certificate verification
    and exception handling for HTTP errors.

    Note that the Client class should NOT contain any Cortex XSOAR specific code,
    i.e. it shouldn't use anything in the ``demisto`` class (functions such as
    ``demisto.args()`` or ``demisto.results()`` or even ``return_results`` and
    ``return_error``.
    You will use the Command Functions to handle XSOAR inputs and outputs.

    When calling an API, you should use the ``_http.request()`` method and you
    can return the raw data to the calling function (usually a Command function).

    You should usually have one function for each API endpoint.

    Look at the code and the commends of this specific class to better understand
    the implementation details.


    Helper Functions
    ----------------

    Helper functions are usually used as utility functions that are used by several
    command functions throughout your code. For example they map arguments to types
    or convert severity formats from integration-specific to XSOAR.
    Many helper functions are already defined in ``CommonServerPython.py`` and are
    often very handy.


    Command Functions
    -----------------

    Command functions perform the mapping between XSOAR inputs and outputs to the
    Client class functions inputs and outputs. As a best practice, they shouldn't
    contain calls to ``demisto.args()``, ``demisto.results()``, ``return_error``
    and ``demisto.command()`` as those should be handled through the ``main()``
    function.
    However, in command functions, use ``demisto`` or ``CommonServerPython.py``
    artifacts, such as ``demisto.debug()`` or the ``CommandResults`` class and the
    ``Common.*`` classes.
    Usually you will have one command function for every specific XSOAR command
    you want to implement in your integration, plus ``test-module``,
    ``fetch-incidents`` and ``fetch-indicators``(if the latter two are supported
    by your integration). Each command function should invoke one specific function
    of the Client class.

    Command functions, when invoked through an XSOAR command usually return data
    using the ``CommandResults`` class, that is then passed to ``return_results()``
    in the ``main()`` function.
    ``return_results()`` is defined in ``CommonServerPython.py`` to return
    the data to XSOAR. ``return_results()`` actually wraps ``demisto.results()``.
    You should never use ``demisto.results()`` directly.

    Sometimes you will need to return values in a format that is not compatible
    with ``CommandResults`` (for example files): in that case you must return a
    data structure that is then pass passed to ``return.results()``. (i.e.
    check the ``scan_results_command`` function in this file that has the option
    to return a file to Cortex XSOAR).

    In any case you should never call ``return_results()`` directly from the
    command functions.

    When you use create the CommandResults object in command functions, you
    usually pass some types of data:

    - Human Readable: usually in Markdown format. This is what is presented to the
    analyst in the War Room. You can use ``tableToMarkdown()``, defined in
    ``CommonServerPython.py``, to convert lists and dicts in Markdown and pass it
    to ``return_results()`` using the ``readable_output`` argument, or the
    ``return_results()`` function will call ``tableToMarkdown()`` automatically for
    you.

    - Context Output: this is the machine readable data, JSON based, that XSOAR can
    parse and manage in the Playbooks or Incident's War Room. The Context Output
    fields should be defined in your integration YML file and is important during
    the design phase. Make sure you define the format and follow best practices.
    You can use ``demisto-sdk json-to-outputs`` to autogenerate the YML file
    outputs section. Context output is passed as the ``outputs`` argument in ``demisto_results()``,
    and the prefix (i.e. ``HelloWorld.Alert``) is passed via the ``outputs_prefix``
    argument.

    More information on Context Outputs, Standards, DBotScore and demisto-sdk:
    https://xsoar.pan.dev/docs/integrations/code-conventions#outputs
    https://xsoar.pan.dev/docs/integrations/context-and-outputs
    https://xsoar.pan.dev/docs/integrations/context-standards
    https://xsoar.pan.dev/docs/integrations/dbot
    https://github.com/demisto/demisto-sdk/blob/master/demisto_sdk/commands/json_to_outputs/README.md

    Also, when you write data in the Context, you want to make sure that if you
    return updated information for an entity, to update it and not append to
    the list of entities (i.e. in HelloWorld you want to update the status of an
    existing ``HelloWorld.Alert`` in the context when you retrieve it, rather than
    adding a new one if you already retrieved it). To update data in the Context,
    you can define which is the key attribute to use, such as (using the example):
    ``outputs_key_field='alert_id'``. This means that you are using the ``alert_id``
    key to determine whether adding a new entry in the context or updating an
    existing one that has the same ID. You can look at the examples to understand
    how it works.
    More information here:
    https://xsoar.pan.dev/docs/integrations/context-and-outputs
    https://xsoar.pan.dev/docs/integrations/code-conventions#outputs
    https://xsoar.pan.dev/docs/integrations/dt

    - Raw Output: this is usually the raw result from your API and is used for
    troubleshooting purposes or for invoking your command from Automation Scripts.
    If not specified, ``return_results()`` will use the same data as ``outputs``.


    Main Function
    -------------

    The ``main()`` function takes care of reading the integration parameters via
    the ``demisto.params()`` function, initializes the Client class and checks the
    different options provided to ``demisto.commands()``, to invoke the correct
    command function passing to it ``demisto.args()`` and returning the data to
    ``return_results()``. If implemented, ``main()`` also invokes the function
    ``fetch_incidents()``with the right parameters and passes the outputs to the
    ``demisto.incidents()`` function. ``main()`` also catches exceptions and
    returns an error message via ``return_error()``.


    Entry Point
    -----------

    This is the integration code entry point. It checks whether the ``__name__``
    variable is ``__main__`` , ``__builtin__`` (for Python 2) or ``builtins`` (for
    Python 3) and then calls the ``main()`` function. Just keep this convention.

    """




    import json
    import urllib3
    import dateparser
    from typing import Any, Dict, Tuple, List, Optional, Union, cast
    from datetime import datetime, timedelta

    # Disable insecure warnings
    urllib3.disable_warnings()

    ''' CONSTANTS '''

    DATE_FORMAT = '%Y-%m-%d %H:%M:%S'
    #DATE_FORMAT = '%Y-%m-%dT%H:%M:%S.000Z'
    # Convert string to datetime using strptime
    #date_obj = datetime.strptime(date_string, date_format)


    MAX_INCIDENTS_TO_FETCH = 50
    DEFAULT_INDICATORS_THRESHOLD = 65
    HELLOWORLD_SEVERITIES = ['Low', 'Medium', 'High', 'Critical']

    templates_names=["Subcontratante - Vendor Tier 2","Supplier Assessment - Vendor Tier 2", "Supplier Assessment - Cyber Vendor Tier 2", "Cyber Vendor Tier 2 PT", "Supplier Assessment - Cyber Vendor Tier 1", "Cyber Vendor Tier 1 PT", "Subcontratante - Tier 1", "Supplier Assessment - Tier 1","RGPD Cyber Tier 1 PT", "RGPD Cyber Tier 2 PT", "RGPD Cyber Tier 1 EN", "RGPD Cyber Tier 2 EN","Cyber Tier 1 PT","Cyber Tier 2 PT","Cyber Tier 1 EN","Cyber Tier 2 EN"]
    excluded_templates = ["PT - Registo de Atividades de Tratamento","ES - Registro de Atividades de Tratamiento","RGPD PT","PT - Avaliação de Impacto sobre a Proteção de Dados (AIPD)","RGPD EN","Sistemas - Modelo de Registo de Recursos"]


    ''' CLIENT CLASS '''


    class Client(BaseClient):

        """Client class to interact with the service API

        This Client implements API calls, and does not contain any Demisto logic.
        Should only do requests and return data.
        It inherits from BaseClient defined in CommonServer Python.
        Most calls use _http_request() that handles proxy, SSL verification, etc.
        For this HelloWorld implementation, no special attributes defined
        """
        def __init__(self, server_url: str, verify: bool, oauth_params: dict):
            self._base_url = server_url
            self._verify = verify
            self._proxies = handle_proxy(proxy_param_name='proxy', checkbox_default_value=False)
            self._oauth_params = oauth_params if oauth_params else {}
        """def __init__(server_url: str, OAuthToken: str,)
            self._OAuthToken = OAuthToken
            self._server_url = server_url
        """


        def send_request(self, path: str, method: str = 'GET', body: dict | None = None, params: dict | None = None, headers: dict | None = None, file=None, sc_api: bool = False, cr_api: bool = False, no_record_found_res: dict = {'result': []}):

            body = body if body is not None else {}
            #print('this is the body:' + str(body))
            params = params if params is not None else {}


            if not headers:
                headers = {
                    'Accept': 'application/json',
                    'Content-Type': 'application/json'
                }

            request_url = self._base_url + path

            #print('request url: ' + request_url)
            #print(self._oauth_params)
            res = requests.request(method=method, url=request_url, headers=self._oauth_params, data=json.dumps(body) if body else {})#, params=params if params else {}, verify=self._verify, proxies=self._proxies)response_to_context()
            #print(res.text)
            #data=json.dumps(body)


            try:
                json_res = res.json()
            except Exception as err:
                if res.status_code == 201:
                    return "The ticket was successfully created."
                if not res.content:
                    return ''
                raise Exception(f'Error parsing reply - {str(res.content)} - {str(err)}')

            if 'error' in json_res:
                error = json_res.get('error', {})
                if res.status_code == 401:
                    demisto.debug(f'Got status code 401 - {json_res}. Retrying ...')
                else:
                    if isinstance(error, dict):
                        message = json_res.get('error', {}).get('message')
                        details = json_res.get('error', {}).get('detail')
                        if message == 'No Record found':
                            return no_record_found_res
                        else:
                            raise Exception(f'OneTrust Error: {message}, details: {details}')
                    else:
                        raise Exception(f'OneTrust: {error}')

            if res.status_code < 200 or res.status_code >= 300:
                if res.status_code != 401 or num_of_tries == (max_retries - 1):
                    raise Exception(
                        f'Got status code {str(res.status_code)} with url with body {str(res.content)}'
                        #f'Got status code {str(res.status_code)} with url #{url} with body {str(res.content)}'
                        f' with headers {str(res.headers)}')
            return json_res





    ''' AUXILIARY CUSTOM FUCNTIONS '''


    def build_arg_url_suffix():
        #arg_list is based on passed params
        arg_list =[]
        for key in demisto.args().keys():
            string = str(key)
            arg_list.append(string)
        args = demisto.args()
        arg_dict = {}
        #Loop, gets all the args values from the given list
        #first we parse the args, check if they are empty
        for arg in arg_list:
            if ',' in args.get(arg, ''):
                my_str = args.get(arg, '')
                my_list = my_str.split(',')
                arg_dict[arg] = my_list
            else:
                arg_dict[arg] = args.get(arg, '')

        url_suffix = ""

        #make url_suffix based on keys, values and number of values
        for key in arg_dict.keys():
            #if a dict value is a list of values, it iterates
            if type(arg_dict[key]) is list:
                value_list = arg_dict[key]
                for value in value_list:
                    url_suffix += f'{key}={value}&'
            else:
                value = arg_dict[key]
                url_suffix += f'{key}={value}&'
        return url_suffix


    def format_date(date):
        """
        Intakes date and return date in proper format: Timestamp to datestring
        """
        new_date = datetime.strptime(date, DATE_FORMAT)
        #print(new_date)
        #print(str(int(time.time()) * 1000))
        date_timestamp = datetime.timestamp(new_date)
        date_timestamp = str(date_timestamp).replace('.', '0')
        date_timestamp = date_timestamp + '0'
        #print(date_timestamp)
        return timestamp_to_datestring(date_timestamp)






    ''' COMMAND FUNCTIONS '''

    def get_assessment_list(client: Client, args: Dict[str, Any]):#, params):
        """Gets the Assement list
        """
        #Get all the args that we might need

        assessment_statuses = args.get('assessment_statuses', '')
        assessment_archival_state = args.get('assessment_archival_state', '')

        #default value is 0
        page = args.get('page', '')

        #default value is set to 10
        size = args.get('size', '')

        #list of arguments to iterate to build url
        ####Put the list in the same order as the URL REQUEST!####
        arg_list = ['assessmentStatuses', 'assessmentArchivalState', 'page', 'size']
        arg_url_suffix = build_arg_url_suffix()

        #url = "https://customer.my.onetrust.com/api/assessment/v2/assessments?assessmentStatuses=IN_PROGRESS&assessmentStatuses=UNDER_REVIEW&assessmentArchivalState=ARCHIVED&page=0&size=20"

        method='GET'
        url_suffix=f'/assessment/v2/assessments?{arg_url_suffix}'
        if url_suffix[-1] == '&':
            url_suffix = url_suffix[:-1]

        response  = client.send_request(path=url_suffix, method=method)#, params=params)

        if response is not None:
            resp = response
            human_readable: str = f"Request for {method} method is successful"
            return CommandResults(
                outputs_prefix="Onetrust.List",
                outputs=resp,
                readable_output=human_readable,
            )

        return f"Request for {method} method is not successful"


    def get_assessment_details(client: Client, args: Dict[str, Any]):
        """
        Retrieve details of a specific assessment by passing the assessmentId as an argument
        """

        assessmentId = args.get('assessmentId')

        method='GET'
        url_suffix=f'/assessment/v2/assessments/{assessmentId}/export'

        """
        Check arg value for ExcludeSkippedQuestions - add it to URL accordingly
        """

        if (argToBoolean(args.get('exclude_skipped_questions'))) is not None:
            arg_url = argToBoolean(args.get('exclude_skipped_questions',''))
            if arg_url != '':
                url_suffix += f'?ExcludeSkippedQuestions={arg_url}'


        response  = client.send_request(path=url_suffix, method=method)#, params=params)

        if response is not None:
            resp = response
            human_readable: str = f"Request for {method} method is successful"
            return CommandResults(
                outputs_prefix=f"Onetrust.Assessment.Details",
                outputs=resp,
                readable_output=human_readable,
            )
        else:
            return f"Request for {method} method is not successful"


    def send_back_assessment(client: Client):
        """
        Send back the assessment to OneTrust in under review
        """
        #https://customer.my.onetrust.com/api/assessment/v2/assessments/{id}/send-back
        #make a list of selected args | arg_list
        arg_list =[]
        for key in demisto.args().keys():
            string = str(key)
            arg_list.append(string)
        args = demisto.args()
        arg_dict = {}

        #Parse the args, check if they are empty
        for arg in arg_list:
            if '' != args.get(arg, ''):
                my_str = args.get(arg, '')
                arg_dict[arg] = my_str
            else:
                arg_dict[arg] = args.get(arg, '')

        assessmentId = arg_dict.pop('assessmentId')




        method='POST'
        url_suffix=f'/assessment/v2/assessments/{assessmentId}/send-back'

        payload = arg_dict

        response  = client.send_request(path=url_suffix, method=method, body=payload)#, params=params

        if response is not None:
            resp = response
            human_readable: str = f"Request for {method} method is successful"
            return human_readable
        else:
            return f"Request for {method} method is not successful"
        """
        argToBoolean(args.get('populate_context', 'true'))
        """
        """
        payload = {
        "editAllResponses": True,
        "emailComment": "this email is urgent",
        "resetApproverReviews": False,
        "sendBulkInfoRequestEmail": True
    }
    headers = {"content-type": "application/json"}

    response = requests.post(url, json=payload, headers=headers)
    """


    def get_all_tags(client: Client):

        method='GET'
        url_suffix='/assessment/v2/assessments/assessment-tags'

        response  = client.send_request(path=url_suffix, method=method)#, params=params)
        print(response.text)

        if response is not None:
            resp = response
            human_readable: str = f"Request for {method} method is successful"
            return CommandResults(
                outputs_prefix="Onetrust.Tags",
                outputs=resp,
                readable_output=human_readable,
            )

        return f"Request for {method} method is not successful"

    def update_assessment_tags(client: Client, args: Dict[str, Any]):

        assessmentId = args.get('assessmentId')

        method='PUT'
        url_suffix=f'/assessment/v2/assessments/{assessmentId}/tags'

        response  = client.send_request(path=url_suffix, method=method)#, params=params)
        print(response.text)

        if response is not None:
            resp = response
            human_readable: str = f"Request for {method} method is successful"
            return CommandResults(
                outputs_prefix=f"Onetrust.Tags.{assessmentId}",
                outputs=resp,
                readable_output=human_readable,
            )

        return f"Request for {method} method is not successful"


    #to do or pre process rule

    def fetch_incidents(client: Client):


        """
        Uses to fetch incidents into Demisto
        Documentation: https://xsoar.pan.dev/docs/integrations/fetching-incidents#the-fetch-incidents-command

        Due to API limitations (The incidents are not ordered and there is a limit of 100 incident for each request),
        We get all the incidents newer than last_run/first_fetch_time and saves them in a queue. The queue is sorted by
        creation date of each incident.

        As long as the queue has more incidents than fetch_limit the function will return the oldest incidents in the queue.
        If the queue is smaller than fetch_limit we fetch more incidents with the same logic described above.


        Args:
            client(Client): client to preform the API calls.
            first_fetch_time(str): From when to fetch if first time, e.g. `3 days`.
            fetch_limit(int): The number of incidents in each fetch.
            timeout(int): The time limit in seconds for this function to run.
                Note: exceeding the time doesnt kill the function just prevents the next api call.
        Returns:
            incidents, new last_run
        """


        method='GET'
        max_fetch = demisto.getParam('max_fetch')
        url_suffix = f"/assessment/v2/assessments?assessmentStatuses=NOT_STARTED&page=0&size={max_fetch}"


        #assessments = response['content']
        #assessments.reverse()
        last_run = demisto.getLastRun()
        #print(last_run)
        #print(type(last_run))


        first_fetch = demisto.getParam('first_fetch')
        first_fetch = datetime.strptime(first_fetch, DATE_FORMAT)

        run_param  = ''

        if last_run:
            run_param = last_run['last_fetch']
            run_param = run_param.replace("T"," ")
            run_param = run_param.replace(".000Z","")
            run_param = datetime.strptime(run_param,DATE_FORMAT)
        else:
            run_param = first_fetch
            url_suffix = f"/assessment/v2/assessments?assessmentStatuses=NOT_STARTED&page=0&size=500"


        response = client.send_request(path=url_suffix, method=method)
        events = response['content']
        events.reverse()

        incidents = []
        #print(incidents)
        for incident in events:
            template_name =incident.get('templateName','')

            if template_name in templates_names:
                createDt = incident.get('createDt','')
                createDt = datetime.strptime(createDt, DATE_FORMAT)
                if createDt >= run_param:
                    ocurred = incident.get('createDt','')
                    ocurred_time = format_date(ocurred)
                    #print(ocurred_time)
                    #print(type(ocurred_time))
                    primaryInventoryDetails = incident.get('primaryInventoryDetails','')
                    InventoryName = primaryInventoryDetails['primaryInventoryName']
                    incident = {

                        "name": f"TPRM assesment UID {incident.get('number','')} - {InventoryName}",
                        'occurred': ocurred_time,  # needs ISO8601
                         #'occurred': timestamp_to_datestring(int(time.time()) * 1000),  # needs ISO8601
                        'rawJSON': json.dumps(incident) # the original event
                    }
                    incidents.append(incident)


        last_run = timestamp_to_datestring(int(time.time()) * 1000) # placeholder

        return incidents, {'last_fetch': last_run}





    ''' MAIN FUNCTION '''


    def main() -> None:
        """
        main function, parses params and runs command functions
        """

        params = demisto.params()
        args = demisto.args()
        command = demisto.command()


        """
        authorization params
        """


        OAuthToken = params.get('OAuthToken')
        server_url = params.get('url')

        """
        first_fetch_time = params.get('first_fetch', '3 days').strip()
        fetch_limit = arg_to_number(params.get('max_fetch', 10))
        fetch_timeout = arg_to_number(params.get('fetch_timeout', TIMEOUT))
        fetch_time = params.get('fetch_time', '10 minutes').strip()
        """

        # get the service API url
        base_url = urljoin(params.get('url'), '/api')

        # if your Client class inherits from BaseClient, SSL verification is
        # handled out of the box by it, just pass ``verify_certificate`` to
        # the Client constructor
        verify_certificate = not params.get('insecure', False)

        # How much time before the first fetch to retrieve incidents
        first_fetch_time = arg_to_datetime(
            arg=params.get('first_fetch', '3 days'),
            arg_name='First fetch time',
            required=True
        )
        first_fetch_timestamp = int(first_fetch_time.timestamp()) if first_fetch_time else None
        # Using assert as a type guard (since first_fetch_time is always an int when required=True)
        assert isinstance(first_fetch_timestamp, int)

        # if your Client class inherits from BaseClient, system proxy is handled
        # out of the box by it, just pass ``proxy`` to the Client constructor
        proxy = params.get('proxy', False)

        # Integration that implements reputation commands (e.g. url, ip, domain,..., etc) must have
        # a reliability score of the source providing the intelligence data.
        reliability = params.get('integrationReliability', DBotScoreReliability.C)

        # INTEGRATION DEVELOPER TIP
        # You can use functions such as ``demisto.debug()``, ``demisto.info()``,
        # etc. to print information in the XSOAR server log. You can set the log
        # level on the server configuration
        # See: https://xsoar.pan.dev/docs/integrations/code-conventions#logging

        demisto.debug(f'Command being called is {command}')
        try:
            headers = {
                'Authorization': f'Bearer {OAuthToken}',
                'Accept': 'application/json',
                'Content-type': 'application/json'
            }
            client = Client(server_url=base_url,verify=verify_certificate,oauth_params=headers)

            if command == 'fetch-incidents':
                #fetch_limit = arg_to_number(fetch_limit)
                #fetch_timeout = arg_to_number(fetch_timeout) if fetch_timeout else None
                incidents, lastRun = fetch_incidents(client=client)#, first_fetch_time, fetch_limit, fetch_timeout)
                demisto.setLastRun(lastRun)
                demisto.incidents(incidents)

            if command == 'onetrust-get-assessment-list':
                # This is the call made when pressing the integration Test button.
                result = get_assessment_list(client=client, args=demisto.args())#, params=params)
                response_to_context(result)
                return_results(result)
                return CommandResults(result)

            if command =='onetrust-get-assessment-details':
                result = get_assessment_details(client=client, args=demisto.args())
                response_to_context(result)
                return_results(result)
                return CommandResults(result)

            if command =='onetrust-send-back-assessment':
                result = send_back_assessment(client=client)
                response_to_context(result)
                return_results(result)
                return CommandResults(result)

            if command =='onetrust-get-all-tags':
                result = get_all_tags(client=client)
                response_to_context(result)
                return_results(result)
                return CommandResults(result)

            if command =='onetrust-update-assessment-tags':
                result = update_assessment_tags(client=client, args=demisto.args())
                response_to_context(result)
                return_results(result)
                return CommandResults(result)

           #else:
            #   raise NotImplementedError(f'Command {command} is not implemented')

        # Log exceptions and return errors
        except Exception as e:
            return_error(f'Failed to execute {command} command.\nError:\n{str(e)}')


    ''' ENTRY POINT '''

    if __name__ in ('__main__', '__builtin__', 'builtins'):
        main()

    register_module_line('HelloWorld', 'end', __line__())
  type: python
  commands:
  - name: onetrust-get-assessment-list
    arguments:
    - name: assessmentStatuses
      auto: PREDEFINED
      predefined:
      - NOT_STARTED
      - IN_PROGRESS
      - UNDER_REVIEW
      - COMPLETED
      description: Status of an assessment. "NOT_STARTED","IN_PROGRESS","UNDER_REVIEW","COMPLETED"
    - name: assessmentArchivalState
      auto: PREDEFINED
      predefined:
      - ALL
      - ARCHIVED
      - NON_ARCHIVED
      description: Parameter to retrieve a list of Active/Archived or both Active
        and Archived assessments.
    - name: page
      description: Page number of the results list (0…N).
      defaultValue: "0"
      type: textArea
    - name: size
      description: Number of records per page (0…N).
      defaultValue: "10"
      type: textArea
    outputs:
    - contextPath: Onetrust.Assessment.List
      description: List of returned Assesments
    description: Retrieve a list OneTrust assessments with basic assessment details
  - name: onetrust-get-assessment-details
    arguments:
    - name: assessmentId
      required: true
      description: ID of an assessment. Will allow to retrieve specified assessment
    - name: exclude_skipped_questions
      default: true
      auto: PREDEFINED
      predefined:
      - "true"
      - "false"
      description: Indicates whether skipped questions are included in the response
        payload. False, questions on the assessment that are hidden by skip or show
        logic will be included in the response payload with the "hidden" boolean set
        to True
      defaultValue: "false"
    description: Retrieve from OneTrust the details of a specific assessment
  - name: onetrust-send-back-assessment
    arguments:
    - name: assessmentId
      required: true
      description: ID of an assessment. Will allow to retrieve specified assessment
      type: textArea
    - name: editAllResponses
      auto: PREDEFINED
      predefined:
      - "true"
      - "false"
      description: Use this field to allow all respondents to edit any question response
        when an assessment is sent back.
    - name: emailComment
      description: Comment to include in the email notification.
      type: textArea
    - name: resetApproverReviews
      auto: PREDEFINED
      predefined:
      - "true"
      - "false"
      description: Use this field to indicate whether the approver’s review is retained
        or removed.
    - name: sendBulkInfoRequestEmail
      auto: PREDEFINED
      predefined:
      - "true"
      - "false"
      description: Use this field to indicate whether to send notifications to all
        assessment respondents in bulk for additional information on multiple questions.
    description: Send back assessment to OneTrust from Under Review to In Progress
  - name: fetch-incidents
    arguments: []
    description: Not to be used as a command
  - name: onetrust-get-all-tags
    arguments: []
    description: Returns all Tags found OneTrust
  - name: onetrust-update-assessment-tags
    arguments:
    - name: assessmentId
      required: true
  dockerimage: demisto/python3:3.10.9.42476
  isfetch: true
  runonce: false
  subtype: python3
sourcemoduleid: Teste_Noet
